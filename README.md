# üìò BookAnalytics
## üîç –û–ø–∏—Å

**BookAnalytics** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∑–±–æ—Ä—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–Ω–∏–≥ —É –±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ –∑ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–º–∏ ORM-–∑–∞–ø–∏—Ç–∞–º–∏, –∫–µ—à—É–≤–∞–Ω–Ω—è–º —Å—Ç–æ—Ä—ñ–Ω–æ–∫, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—é –æ–±—Ä–æ–±–∫–æ—é –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ Celery + Redis, –∞ —Ç–∞–∫–æ–∂ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è–º –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é django-debug-toolbar.

---

## üìå –ó–º—ñ—Å—Ç

**1.** [‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫](#-–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è-—Ç–∞-–∑–∞–ø—É—Å–∫)

**2.** [üóÑÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –º–æ–¥–µ–ª—ñ](#-–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞-—Ç–∞-–º–æ–¥–µ–ª—ñ)

**3.** [üë§ Cookies —Ç–∞ —Å–µ—Å—ñ—ó](#-cookies-—Ç–∞-—Å–µ—Å—ñ—ó)

**4.** [‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è ORM](#-–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è-orm)

**5.** [üß† –ö–µ—à—É–≤–∞–Ω–Ω—è](#-–∫–µ—à—É–≤–∞–Ω–Ω—è)

**6.** [üîß Middleware –∫–µ—à—É–≤–∞–Ω–Ω—è](#-middleware-–∫–µ—à—É–≤–∞–Ω–Ω—è)

**7.** [üìä –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (Debug Toolbar)](#-–∞–Ω–∞–ª—ñ–∑-–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ)

**8.** [üöÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –∑–∞–¥–∞—á—ñ Celery](#-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ-–∑–∞–¥–∞—á—ñ-celery)

**9.** [üñº –ì–∞–ª–µ—Ä–µ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤](#-–≥–∞–ª–µ—Ä–µ—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤)

**10.** [üìà Raw SQL, —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è —Ç–∞ NoSQL](#-raw-sql-—ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è-—Ç–∞-nosql)

---


# ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫
```bash
git clone <repo_url>
cd Homework24
python -m venv venv
source venv/bin/activate   # –∞–±–æ venv\Scripts\activate –Ω–∞ Windows
pip install -r requirements.txt
```

## üìå –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Redis (Ubuntu)
```bash
sudo apt install redis
sudo service redis-server start
```
## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
python manage.py migrate
python manage.py runserver
```
## üö¶ –ó–∞–ø—É—Å–∫ Celery
```bash
celery -A homework24 worker -l info
```
# üóÑÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –º–æ–¥–µ–ª—ñ

–£ –ø—Ä–æ—î–∫—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –º–æ–¥–µ–ª—ñ:


| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ |
|-----------|-------------|
| Backend | Django |
| Sessions | Django DB Sessions |
| Cookies | HttpOnly Cookies + auto-refresh |
| ORM | select_related, prefetch_related |
| Cache | Redis / Memcached |
| Async | Celery + Redis |
| Debug | Django Debug Toolbar |
| DB | PostgreSQL/MySQL/SQLite + MongoDB/Firebase |
| NoSQL | MongoDB/Firebase |
| Email | SMTP (–ª–æ–∫–∞–ª—å–Ω–∏–π / —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π) |

| –ú–æ–¥–µ–ª—å     | –û–ø–∏—Å               |
|------------|--------------------|
| `Author`   | –ê–≤—Ç–æ—Ä –∫–Ω–∏–≥–∏        |
| `Book`     | –ö–Ω–∏–≥–∞              |
| `Review`   | –í—ñ–¥–≥—É–∫ –∑ —Ä–µ–π—Ç–∏–Ω–≥–æ–º |

–ó–≤ º—è–∑–∫–∏:

* `Author ‚Üí Book` (–æ–¥–∏–Ω-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö)
* `Book ‚Üí Review` (–æ–¥–∏–Ω-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö)

---

# üë§ Cookies —Ç–∞ —Å–µ—Å—ñ—ó

–£ –ø—Ä–æ–µ–∫—Ç—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ:

‚úîÔ∏è –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è **—ñ–º–µ–Ω—ñ –≤ cookies**

‚úîÔ∏è –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è **–≤—ñ–∫—É –≤ —Å–µ—Å—ñ—ó**

‚úîÔ∏è –ê–≤—Ç–æ–ø–æ–¥–æ–≤–∂–µ–Ω–Ω—è cookies –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

‚úîÔ∏è –ö–Ω–æ–ø–∫–∞ **¬´–í–∏–π—Ç–∏¬ª** –∑ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –¥–∞–Ω–∏—Ö

---

# ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è ORM

–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤:

| –ë–µ–∑ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó | –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ |
|-----------------|--------------|
|–ë–∞–≥–∞—Ç–æ SQL | ``select_related``, ``prefetch_related`` |
|–ü–æ–≤—ñ–ª—å–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä |	–ó–±—ñ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –¥–∞–Ω–∏—Ö –æ–¥–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º |
|–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –ë–î |	–ï–∫–æ–Ω–æ–º—ñ—è –ø–∞–º‚Äô—è—Ç—ñ |

---

# üß† –ö–µ—à—É–≤–∞–Ω–Ω—è

‚úîÔ∏è –ö–µ—à—É–≤–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É –∫–Ω–∏–≥

‚úîÔ∏è –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–µ—à—É –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ/–∑–º—ñ–Ω—ñ –∫–Ω–∏–≥–∏

‚úîÔ∏è –ó–∞–º—ñ–Ω–∞ —Ä—É—á–Ω–æ–≥–æ –∫–µ—à—É –Ω–∞ Redis/Memcached

---

# üîß Middleware –∫–µ—à—É–≤–∞–Ω–Ω—è
üìå``` BookCacheMiddleware```

* –ö–µ—à—É—î **—Å—Ç–æ—Ä—ñ–Ω–∫—É —Å–ø–∏—Å–∫—É –∫–Ω–∏–≥ ```/analytics/``` –ª–∏—à–µ –¥–ª—è –∞–Ω–æ–Ω—ñ–º–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**

* –ü—Ä–∏—Å–∫–æ—Ä—é—î –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∑–∞–ø–∏—Ç–∏

---

# üìä –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ **django-debug-toolbar** –¥–ª—è:

* –ê–Ω–∞–ª—ñ–∑—É SQL-–∑–∞–ø–∏—Ç—ñ–≤

* –í–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞–¥–ª–∏—à–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

* –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —à–∞–±–ª–æ–Ω—ñ–≤

* –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ —à–≤–∏–¥–∫–æ–¥—ñ—ó –∑ –∫–µ—à–µ–º

---

# üöÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –∑–∞–¥–∞—á—ñ Celery

Celery –≤–∏–∫–æ–Ω—É—î:

‚úîÔ∏è üìä –∑–±—ñ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–Ω–∏–≥–∞—Ö

‚úîÔ∏è üì§ –≤—ñ–¥–ø—Ä–∞–≤–∫—É email –∑—ñ –∑–≤—ñ—Ç–æ–º

–ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è.

---

# üñº –ì–∞–ª–µ—Ä–µ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
### üîç –ê–Ω–∞–ª—ñ–∑ Django Debug Toolbar
<img src="screenshots/django-toolbar.png" width="700">	

### ‚ö° –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ ORM
<img src="screenshots/orm-time.png" width="700">

### üì® –í–∏–∫–æ–Ω–∞–Ω–Ω—è Celery –∑–∞–≤–¥–∞–Ω–Ω—è
<img src="screenshots/celery.png" width="700">

### üß† –ö–µ—à—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Redis
<img src="screenshots/redis-cache-test.png" width="700">

---

# üìà Raw SQL, —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è —Ç–∞ NoSQL

‚úîÔ∏è –í–∏–∫–æ–Ω–∞–Ω–æ —Å–∏—Ä—ñ SQL-–∑–∞–ø–∏—Ç–∏ –∑ –±–µ–∑–ø–µ—á–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

‚úîÔ∏è –î–æ–¥–∞–Ω–æ —ñ–Ω–¥–µ–∫—Å–∏ –¥–æ –º–æ–¥–µ–ª–µ–π (```rating```, ```book_id```)

‚úîÔ∏è –ü–æ—Ä—ñ–≤–Ω—è–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ä–µ–ª—è—Ü—ñ–π–Ω–æ—ó –ë–î –∑ **MongoDB/Firebase**

---
